## 上传漏洞

![upload](./images/upload.png)

- 前端验证：直接禁js
- WAF绕过
  - 垃圾数据
  - filename
  - POST/GET
  - 利用waf本身缺陷

## 任意用户密码重置

- 验证码不失效。
- 验证码直接返回。
- 验证码未绑定用户：在提交手机号和验证码的时候，替换手机号为他人手机号进行测试，成功通过验证并重置他人密码。
- 修改接收的手机或邮箱：用户名、手机号、验证码三者没有统一进行验证，仅判断了三者中的手机号（或邮箱）和验证码是否匹配。
- 本地验证的绕过（前端验证）：修改返回包flag。Burpsuite的右键intercept->Response。
- 跳过验证步骤：对修改密码的步骤，没有做校验，导致可以直接输入最终修改密码的网址，并可直接跳转到该页面，然后输入新密码达到重置密码的目的。setup重装也涉及step跳转。
- 未校验用户字段的值：在整个重置密码的流程中，只对验证码和手机号做了校验，未对后面设置新密码的用户身份做判断，导致在最后一步通过修改用户身份来重置他人的密码。
- 修改密码处id可替换：修改密码的时候，没有对原密码进行判断，且仅根据id的值来修改用户的密码，类似SQL语句：update user set password = “123456” where id = “1”，修改数据包里的id的值，即可修改他人密码。
- cookie值的替换：重置密码走到最后一步的时候仅判断唯一的用户标识 cookie是否存在，并没有判断该cookie有没有通过之前重置密码过程的验证，导致可替换cookie重置他人用户密码。（cookie可指定用户获取）
- 修改信息时替换字段值。