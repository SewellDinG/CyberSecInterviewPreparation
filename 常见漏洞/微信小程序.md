Ref：[微信小程序的渗透五脉](https://www.hackinn.com/index.php/archives/672)

## 信息搜集

获取小程序（名称、简介、开发者信息）

搜集接口信息，微信小程序沙箱机制 -> 域名白名单机制（更多资料中泄露） -> 近支持 https 和 wss协议请求。

##提取wxapkg并导入本地工程

小程序数据包后缀wxapkg，各类资源文件虽然未被加密，但都压缩到一个资源文件中。（Mac新版微信有加密，还是使用安卓提取方便）

从root的安卓机pull下来wxapkg数据包，使用wxappUnpacker解包工具自动解包。

打开微信小程序开发者工具，选择“导入项目”，“AppID”选择测试号并导入；接着来到“本地设置”模块，勾选上“不校验合法域名”功能就可以本地调试了。

## 常见漏洞

1、各类逻辑漏洞，2、水平越权，3、SQL注入，4、任意文件上传等。

不包含XXS漏洞，因为微信小程序的特性是不能执行动态脚本的。

CSRF、JSON劫持、CORS劫持等需要用户交互才能触发的漏洞基本上不会存在，因为这类攻击都是基于浏览器对用户的信任，而小程序内用户的一切操作都是在微信沙盒内完成的，攻击者无法通过浏览器利用用户在小程序内的身份凭据来完成攻击。

此外类似于URL跳转、CRLF注入、目录遍历等的中/低危漏洞由于后端API的特性（大多以JSON格式返回数据）而基本上也不复存在。