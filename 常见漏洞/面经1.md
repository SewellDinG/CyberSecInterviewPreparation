## 注入

注入和xss几乎是所有厂商必问的题目（小型厂商问得多，大型厂商问得少或者不问）。

### 1、什么是布尔型注入/盲注？

盲注的本质是猜解（所谓 “盲” 就是在你看不到返回数据的情况下能通过 “感觉” 来判断），那能感觉到什么？答案是**：差异**（包括**运行时间的差异**和**页面返回结果的差异**）。构造一条语句来测试输入的**布尔表达式**，使得布尔表达式结果的真假直接影响整条语句的执行结果，从而使得系统有不同的反应，在时间盲注中是不同的返回的时间，在布尔盲注中则是不同的页面反应。

基于布尔的盲注：Web页面的返回值只有两种，True和False，所以我们只能通过测试输入的注入语句为Ture或False来判断注入的效果，并通过这两种可能一步步得出数据库的信息。盲注思路的思路很多，比如字符串截取对比substr()、比较函数strcmp()、正则匹配、运算符等。

基于时间的盲注：Web页面的返回值只有一种，True。无论我们输入任何值，它的返回情况都会按正确的处理。无法通过返回页面正确或是错误来推断信息。因此，加入特定的时间函数，通过查看是Web页面返回的时间来判断注入的语句是否正确，以此得出数据库的信息。时间盲注也叫延时注入，一般用到函数sleep()、BENCHMARK()、还可以使用笛卡尔积（不推荐使用，当数据过多时会造成DOS）。

在如今的实际环境中一般盲注的情况很多，其中基于时间盲注太费时间，同时对网络要求比较高。可以使用二分法、或利用DNSLog进行OOB等等可以加快注入的过程。

sleep的次数=返回的数据条数。盲注中尽量使用and，避免or，因为使用or会使不存在的数据也sleep。参考[1](https://www.t00ls.net/thread-45590-1-10.html)love71师傅的评论。

### 2、造成注入漏洞的原因是？怎么防护？

直接原因：用户输入的数据被SQL解释器执行。CRUD

注入的漏洞本质是代码和数据未分离，通过在用户可控参数中注入SQL语法，程序未对输入的数据进行合法性判断，注入进去的恶意语句就会被数据库服务器误认为是正常的SQL指令而运行，破坏原有 SQL 结构，达到编写程序时意料之外结果的攻击行为。

防御：**采用SQL语句的预编译和绑定变量，是防御SQL注入的最佳方法，参考[1](https://www.mscto.com/sql/109735.html)**。严格检查参数的数据类型，使用一些安全函数。

### 3、SQL Server/MySQL GetShell的几种姿势？

### 4、MySQL UDF提权？

### 5、SQL绕WAF姿势？

[https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI](https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI)

### 6、Redis在Windows底下如何GetShell？

[https://www.t00ls.net/viewthread.php?tid=56522](https://www.t00ls.net/viewthread.php?tid=56522)

### 7、DNS注入的原理？

盲注跑数据太慢的情况下，可以选择DNS注入。

域名DNS指向的是我们服务器的域名，意味着解析域名时需向我们的dns服务器查询。通过递归查询可以获取数据库上的信息，我们从dns解析日志来查看信息。域名有字符限制，UNC也有。

SQLMAP的`--dns-domain=attacker.com`选项可以指定dnslog，但是因为 sqlmap 在运行过程中遵循的是 union 和 error-base 优先级最高的原则，所以只有当攻击是基于 blind 并且用户使用了上面的选项时 dns 注入才会开始。

MySQL用的payload多是load_file()请求UNC；load_file()读取文件的函数需要自身的条件，如secure_file_priv为空；UNC限制了目标只能是Windows环境。MsSQL可以直接利用master..xp_dirtree来请求URL。Oracle、PostgreSQL直接sqlmap一把梭，也有payload。

如果有特殊符号，如@，可以先hex，如MySQL的select hex(user())；使用group_concat()查询多个数据，由于存在逗号，也需要先hex，select hex(group_concat(table_name)) from xxx。

## XSS

XSS与注入同理，是面试最爱问的。

### 1、储型XSS，反射型XSS，DOM型的区别？

### 2、XSS字符绕过？

### 3、XSS的防御？

### 4、某网站有XSS，后台只能内网访问，如何GetShell？

### 5、蠕虫型XSS，XSS探测内网姿势？

## CSRF

### 1、csrf原理及防御？

### 2、csrf怎么绕过referer防御

## 杂项

### 1、XXE/SSRF的漏洞原理及防御方式？

### 2、XXE/SSRF的深层利用？

### 3、Tomcat知道后台管理密码，但是没开管理页面，怎么GetShell？

### 4、反序列化漏洞原理？

### 5、竞争条件漏洞产生原因？

### 6、钓鱼发件人伪造？

### 7、黄金/白银票据的原理及区别？

### 8、ntlm认证流程？

### 9、如何绕流量/杀毒设备？

### 10、过免杀，过自启动姿势？